<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>å‹•ç”»é…ä¿¡ã‚µã‚¤ãƒˆPiPãƒ†ã‚¹ãƒˆ - YouTubeé¢¨</title>
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        margin: 0;
        padding: 20px;
        background-color: #0f0f0f;
        color: white;
      }
      .container {
        max-width: 1200px;
        margin: 0 auto;
      }
      .video-container {
        position: relative;
        width: 100%;
        max-width: 854px;
        margin: 0 auto 20px;
        background: #000;
        border-radius: 12px;
        overflow: hidden;
      }
      .video-player {
        width: 100%;
        height: 480px;
        background: linear-gradient(45deg, #1a1a1a, #333);
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .test-video {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }
      .video-info {
        padding: 16px;
        background: #0f0f0f;
      }
      .video-title {
        font-size: 20px;
        font-weight: 600;
        margin-bottom: 12px;
        line-height: 1.3;
      }
      .video-meta {
        display: flex;
        align-items: center;
        gap: 12px;
        color: #aaaaaa;
        font-size: 14px;
      }
      .test-buttons {
        display: flex;
        gap: 12px;
        margin: 20px 0;
        flex-wrap: wrap;
      }
      .test-btn {
        padding: 12px 24px;
        background: #ff0000;
        color: white;
        border: none;
        border-radius: 20px;
        cursor: pointer;
        font-weight: 600;
        transition: background 0.2s ease;
        font-size: 14px;
      }
      .test-btn:hover {
        background: #cc0000;
      }
      .test-btn.secondary {
        background: #065fd4;
      }
      .test-btn.secondary:hover {
        background: #0a4ba0;
      }
      .test-btn.success {
        background: #00c851;
      }
      .test-btn.success:hover {
        background: #00a041;
      }
      .sidebar {
        margin-top: 20px;
      }
      .related-video {
        display: flex;
        gap: 12px;
        margin-bottom: 12px;
        padding: 8px;
        border-radius: 8px;
        background: #1f1f1f;
      }
      .related-video img {
        width: 168px;
        height: 94px;
        border-radius: 8px;
        background: #333;
        object-fit: cover;
      }
      .related-info {
        flex: 1;
      }
      .related-title {
        font-size: 14px;
        font-weight: 500;
        margin-bottom: 4px;
        line-height: 1.3;
      }
      .related-meta {
        font-size: 12px;
        color: #aaaaaa;
      }
      .status {
        margin: 20px 0;
        padding: 12px;
        border-radius: 8px;
        background: #1f1f1f;
      }
      .iframe-container {
        margin: 20px 0;
        border-radius: 12px;
        overflow: hidden;
        background: #000;
      }
      .iframe-container iframe {
        width: 100%;
        height: 315px;
        border: none;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>ğŸ¬ å‹•ç”»é…ä¿¡ã‚µã‚¤ãƒˆå¼·åˆ¶PiPãƒ†ã‚¹ãƒˆ</h1>

      <div class="status">
        <h3>ğŸ“Š ç¾åœ¨ã®ã‚µã‚¤ãƒˆçŠ¶æ³</h3>
        <p id="siteStatus">ã‚µã‚¤ãƒˆåˆ¤å®šä¸­...</p>
        <p id="pipStatus">PiPæ©Ÿèƒ½çŠ¶æ³: åˆæœŸåŒ–ä¸­...</p>
      </div>

      <!-- ãƒ¡ã‚¤ãƒ³ã®å‹•ç”»ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ï¼ˆdisablepictureinpictureã‚ã‚Šï¼‰ -->
      <div class="video-container">
        <div class="video-player">
          <video
            id="mainVideo"
            class="test-video"
            controls
            disablepictureinpicture
            poster="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='854' height='480'%3E%3Crect width='100%25' height='100%25' fill='%23000'/%3E%3Ctext x='50%25' y='50%25' text-anchor='middle' fill='white' font-size='24'%3EğŸ¬ ãƒ¡ã‚¤ãƒ³å‹•ç”» (PiPç„¡åŠ¹åŒ–æ¸ˆã¿)%3C/text%3E%3C/svg%3E"
          >
            <source
              src="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4"
              type="video/mp4"
            />
            <source
              src="https://www.learningcontainer.com/wp-content/uploads/2020/05/sample-mp4-file.mp4"
              type="video/mp4"
            />
            <p>å‹•ç”»ã‚’å†ç”Ÿã§ãã¾ã›ã‚“ã€‚</p>
          </video>
        </div>
        <div class="video-info">
          <h2 class="video-title">
            ğŸ”´ ãƒ©ã‚¤ãƒ–é…ä¿¡ãƒ†ã‚¹ãƒˆ - disablepictureinpictureå±æ€§ä»˜ãå‹•ç”»
          </h2>
          <div class="video-meta">
            <span>1,234,567å›è¦–è´</span>
            <span>â€¢</span>
            <span>2024å¹´6æœˆ9æ—¥ã«ãƒ©ã‚¤ãƒ–é…ä¿¡</span>
          </div>
        </div>
      </div>

      <!-- ãƒ†ã‚¹ãƒˆç”¨ãƒœã‚¿ãƒ³ç¾¤ -->
      <div class="test-buttons">
        <button class="test-btn" onclick="testNormalPiP()">
          ğŸ“º é€šå¸¸PiPè©¦è¡Œ
        </button>
        <button class="test-btn secondary" onclick="testForcePiP()">
          ğŸš€ å¼·åˆ¶PiPå®Ÿè¡Œ
        </button>
        <button class="test-btn success" onclick="testStreamingPiP()">
          ğŸ¯ é…ä¿¡ã‚µã‚¤ãƒˆå‘ã‘PiP
        </button>
        <button class="test-btn" onclick="testFrameCapture()">
          ğŸ“¸ ãƒ•ãƒ¬ãƒ¼ãƒ ã‚­ãƒ£ãƒ—ãƒãƒ£
        </button>
        <button class="test-btn secondary" onclick="testAreaCapture()">
          ğŸª å‹•ç”»é ˜åŸŸã‚­ãƒ£ãƒ—ãƒãƒ£
        </button>
        <button class="test-btn" onclick="testScreenCapture()">
          ğŸ–¥ï¸ ç”»é¢ã‚­ãƒ£ãƒ—ãƒãƒ£
        </button>
        <button
          class="test-btn"
          onclick="exitAllPiP()"
          style="background: #ff6b6b"
        >
          âŒ å…¨PiPçµ‚äº†
        </button>
      </div>

      <!-- åŸ‹ã‚è¾¼ã¿å‹•ç”»ï¼ˆiframeï¼‰ -->
      <div class="iframe-container">
        <h3>ğŸ“º åŸ‹ã‚è¾¼ã¿å‹•ç”»ãƒ†ã‚¹ãƒˆ</h3>
        <iframe
          id="embeddedVideo"
          src="data:text/html,%3Chtml%3E%3Cbody style='margin:0;background:%23000;display:flex;align-items:center;justify-content:center;color:white;font-family:Arial;'%3E%3Cvideo controls disablepictureinpicture style='width:100%25;height:100%25;'%3E%3Csource src='https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4' type='video/mp4'%3E%3C/video%3E%3C/body%3E%3C/html%3E"
          allowfullscreen
        >
        </iframe>
      </div>

      <!-- é–¢é€£å‹•ç”» -->
      <div class="sidebar">
        <h3>ğŸ“‹ é–¢é€£å‹•ç”»</h3>
        <div class="related-video">
          <img
            src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='168' height='94'%3E%3Crect width='100%25' height='100%25' fill='%23333'/%3E%3Ctext x='50%25' y='50%25' text-anchor='middle' fill='white' font-size='12'%3Eé–¢é€£å‹•ç”»1%3C/text%3E%3C/svg%3E"
            alt="é–¢é€£å‹•ç”»1"
          />
          <div class="related-info">
            <div class="related-title">YouTubeé¢¨ã‚µã‚¤ãƒˆã§ã®PiPãƒ†ã‚¹ãƒˆæ–¹æ³•</div>
            <div class="related-meta">
              ãƒ†ã‚¹ãƒˆãƒãƒ£ãƒ³ãƒãƒ« â€¢ 123ä¸‡å›è¦–è´ â€¢ 1æ—¥å‰
            </div>
          </div>
        </div>
        <div class="related-video">
          <img
            src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='168' height='94'%3E%3Crect width='100%25' height='100%25' fill='%23333'/%3E%3Ctext x='50%25' y='50%25' text-anchor='middle' fill='white' font-size='12'%3Eé–¢é€£å‹•ç”»2%3C/text%3E%3C/svg%3E"
            alt="é–¢é€£å‹•ç”»2"
          />
          <div class="related-info">
            <div class="related-title">TVerã§PiPã‚’å¼·åˆ¶çš„ã«æœ‰åŠ¹ã«ã™ã‚‹æ–¹æ³•</div>
            <div class="related-meta">
              é–‹ç™ºè€…ãƒãƒ£ãƒ³ãƒãƒ« â€¢ 456ä¸‡å›è¦–è´ â€¢ 3æ—¥å‰
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      // ã‚µã‚¤ãƒˆåˆ¤å®šã¨PiPæ©Ÿèƒ½ã®åˆæœŸåŒ–çŠ¶æ³ã‚’è¡¨ç¤º
      function updateStatus() {
        const domain = window.location.hostname || "localhost";
        const siteStatus = document.getElementById("siteStatus");
        const pipStatus = document.getElementById("pipStatus");

        siteStatus.textContent = `ç¾åœ¨ã®ãƒ‰ãƒ¡ã‚¤ãƒ³: ${domain} (ãƒ†ã‚¹ãƒˆã‚µã‚¤ãƒˆ)`;

        if (typeof window.pipHandler !== "undefined") {
          pipStatus.textContent =
            "PiPæ©Ÿèƒ½çŠ¶æ³: âœ… PictureInPictureHandleråˆæœŸåŒ–æ¸ˆã¿";
          pipStatus.style.color = "#4CAF50";
        } else {
          pipStatus.textContent =
            "PiPæ©Ÿèƒ½çŠ¶æ³: âŒ PictureInPictureHandleræœªåˆæœŸåŒ–";
          pipStatus.style.color = "#f44336";
        }
      }

      // é€šå¸¸ã®PiPè©¦è¡Œ
      function testNormalPiP() {
        console.log("=== é€šå¸¸PiPè©¦è¡Œãƒ†ã‚¹ãƒˆ ===");
        const video = document.getElementById("mainVideo");

        if (video && video.requestPictureInPicture) {
          video
            .requestPictureInPicture()
            .then(() => {
              console.log("âœ… é€šå¸¸PiPæˆåŠŸ");
              alert("âœ… é€šå¸¸PiPãŒæˆåŠŸã—ã¾ã—ãŸï¼");
            })
            .catch((error) => {
              console.error("âŒ é€šå¸¸PiPå¤±æ•—:", error);
              alert(`âŒ é€šå¸¸PiPå¤±æ•—: ${error.message}`);
            });
        } else {
          alert("âŒ PiP APIãŒåˆ©ç”¨ã§ãã¾ã›ã‚“");
        }
      }

      // å¼·åˆ¶PiPå®Ÿè¡Œ
      function testForcePiP() {
        console.log("=== å¼·åˆ¶PiPå®Ÿè¡Œãƒ†ã‚¹ãƒˆ ===");

        if (typeof window.pipHandler !== "undefined") {
          try {
            const result = window.pipHandler.executePictureInPicture();
            console.log("å¼·åˆ¶PiPå®Ÿè¡Œçµæœ:", result);
          } catch (error) {
            console.error("å¼·åˆ¶PiPå®Ÿè¡Œã‚¨ãƒ©ãƒ¼:", error);
            alert(`âŒ å¼·åˆ¶PiPå®Ÿè¡Œã‚¨ãƒ©ãƒ¼: ${error.message}`);
          }
        } else {
          alert("âŒ PictureInPictureHandlerãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“");
        }
      }

      // é…ä¿¡ã‚µã‚¤ãƒˆå‘ã‘PiP
      function testStreamingPiP() {
        console.log("=== é…ä¿¡ã‚µã‚¤ãƒˆå‘ã‘PiPå®Ÿè¡Œãƒ†ã‚¹ãƒˆ ===");

        if (typeof window.forceVideoStreamingPiP !== "undefined") {
          try {
            const result = window.forceVideoStreamingPiP();
            console.log("é…ä¿¡ã‚µã‚¤ãƒˆå‘ã‘PiPå®Ÿè¡Œçµæœ:", result);
            if (result) {
              alert("âœ… é…ä¿¡ã‚µã‚¤ãƒˆå‘ã‘PiPãŒæˆåŠŸã—ã¾ã—ãŸï¼");
            } else {
              alert("âš ï¸ é…ä¿¡ã‚µã‚¤ãƒˆå‘ã‘PiPãŒå¤±æ•—ã—ã¾ã—ãŸ");
            }
          } catch (error) {
            console.error("é…ä¿¡ã‚µã‚¤ãƒˆå‘ã‘PiPã‚¨ãƒ©ãƒ¼:", error);
            alert(`âŒ é…ä¿¡ã‚µã‚¤ãƒˆå‘ã‘PiPã‚¨ãƒ©ãƒ¼: ${error.message}`);
          }
        } else {
          alert("âŒ forceVideoStreamingPiPé–¢æ•°ãŒåˆ©ç”¨ã§ãã¾ã›ã‚“");
        }
      }

      // ãƒ•ãƒ¬ãƒ¼ãƒ ã‚­ãƒ£ãƒ—ãƒãƒ£
      function testFrameCapture() {
        console.log("=== ãƒ•ãƒ¬ãƒ¼ãƒ ã‚­ãƒ£ãƒ—ãƒãƒ£ãƒ†ã‚¹ãƒˆ ===");

        if (typeof window.tryFrameCapturePiP !== "undefined") {
          try {
            const result = window.tryFrameCapturePiP();
            console.log("ãƒ•ãƒ¬ãƒ¼ãƒ ã‚­ãƒ£ãƒ—ãƒãƒ£å®Ÿè¡Œçµæœ:", result);
            if (result) {
              alert("âœ… ãƒ•ãƒ¬ãƒ¼ãƒ ã‚­ãƒ£ãƒ—ãƒãƒ£PiPãŒæˆåŠŸã—ã¾ã—ãŸï¼");
            } else {
              alert("âš ï¸ ãƒ•ãƒ¬ãƒ¼ãƒ ã‚­ãƒ£ãƒ—ãƒãƒ£PiPãŒå¤±æ•—ã—ã¾ã—ãŸ");
            }
          } catch (error) {
            console.error("ãƒ•ãƒ¬ãƒ¼ãƒ ã‚­ãƒ£ãƒ—ãƒãƒ£ã‚¨ãƒ©ãƒ¼:", error);
            alert(`âŒ ãƒ•ãƒ¬ãƒ¼ãƒ ã‚­ãƒ£ãƒ—ãƒãƒ£ã‚¨ãƒ©ãƒ¼: ${error.message}`);
          }
        } else {
          alert("âŒ tryFrameCapturePiPé–¢æ•°ãŒåˆ©ç”¨ã§ãã¾ã›ã‚“");
        }
      }

      // å‹•ç”»é ˜åŸŸã‚­ãƒ£ãƒ—ãƒãƒ£
      function testAreaCapture() {
        console.log("=== å‹•ç”»é ˜åŸŸã‚­ãƒ£ãƒ—ãƒãƒ£ãƒ†ã‚¹ãƒˆ ===");

        if (typeof window.tryVideoAreaCapture !== "undefined") {
          try {
            const result = window.tryVideoAreaCapture();
            console.log("å‹•ç”»é ˜åŸŸã‚­ãƒ£ãƒ—ãƒãƒ£å®Ÿè¡Œçµæœ:", result);
            if (result) {
              alert("âœ… å‹•ç”»é ˜åŸŸã‚­ãƒ£ãƒ—ãƒãƒ£PiPãŒæˆåŠŸã—ã¾ã—ãŸï¼");
            } else {
              alert("âš ï¸ å‹•ç”»é ˜åŸŸã‚­ãƒ£ãƒ—ãƒãƒ£PiPãŒå¤±æ•—ã—ã¾ã—ãŸ");
            }
          } catch (error) {
            console.error("å‹•ç”»é ˜åŸŸã‚­ãƒ£ãƒ—ãƒãƒ£ã‚¨ãƒ©ãƒ¼:", error);
            alert(`âŒ å‹•ç”»é ˜åŸŸã‚­ãƒ£ãƒ—ãƒãƒ£ã‚¨ãƒ©ãƒ¼: ${error.message}`);
          }
        } else {
          alert("âŒ tryVideoAreaCaptureé–¢æ•°ãŒåˆ©ç”¨ã§ãã¾ã›ã‚“");
        }
      }

      // ç”»é¢ã‚­ãƒ£ãƒ—ãƒãƒ£
      function testScreenCapture() {
        console.log("=== ç”»é¢ã‚­ãƒ£ãƒ—ãƒãƒ£ãƒ†ã‚¹ãƒˆ ===");

        if (typeof window.createScreenCapturePiP !== "undefined") {
          try {
            const result = window.createScreenCapturePiP();
            console.log("ç”»é¢ã‚­ãƒ£ãƒ—ãƒãƒ£å®Ÿè¡Œçµæœ:", result);
            alert("âœ… ç”»é¢ã‚­ãƒ£ãƒ—ãƒãƒ£PiPã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒä½œæˆã•ã‚Œã¾ã—ãŸï¼");
          } catch (error) {
            console.error("ç”»é¢ã‚­ãƒ£ãƒ—ãƒãƒ£ã‚¨ãƒ©ãƒ¼:", error);
            alert(`âŒ ç”»é¢ã‚­ãƒ£ãƒ—ãƒãƒ£ã‚¨ãƒ©ãƒ¼: ${error.message}`);
          }
        } else {
          alert("âŒ createScreenCapturePiPé–¢æ•°ãŒåˆ©ç”¨ã§ãã¾ã›ã‚“");
        }
      }

      // å…¨PiPçµ‚äº†
      function exitAllPiP() {
        console.log("=== å…¨PiPçµ‚äº†ãƒ†ã‚¹ãƒˆ ===");

        if (typeof window.exitAllPiP !== "undefined") {
          try {
            window.exitAllPiP();
            alert("âœ… å…¨ã¦ã®PiPã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’çµ‚äº†ã—ã¾ã—ãŸ");
          } catch (error) {
            console.error("å…¨PiPçµ‚äº†ã‚¨ãƒ©ãƒ¼:", error);
            alert(`âŒ å…¨PiPçµ‚äº†ã‚¨ãƒ©ãƒ¼: ${error.message}`);
          }
        } else {
          alert("âŒ exitAllPiPé–¢æ•°ãŒåˆ©ç”¨ã§ãã¾ã›ã‚“");
        }
      }

      // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«çŠ¶æ³ã‚’æ›´æ–°
      document.addEventListener("DOMContentLoaded", () => {
        updateStatus();

        // 1ç§’å¾Œã«å†åº¦ãƒã‚§ãƒƒã‚¯ï¼ˆPiPãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã®åˆæœŸåŒ–ã‚’å¾…ã¤ï¼‰
        setTimeout(updateStatus, 1000);

        console.log("ğŸ¬ å‹•ç”»é…ä¿¡ã‚µã‚¤ãƒˆPiPãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ãŒèª­ã¿è¾¼ã¾ã‚Œã¾ã—ãŸ");
        console.log("åˆ©ç”¨å¯èƒ½ãªãƒ†ã‚¹ãƒˆæ©Ÿèƒ½:");
        console.log("- é€šå¸¸PiPè©¦è¡Œ");
        console.log("- å¼·åˆ¶PiPå®Ÿè¡Œ");
        console.log("- é…ä¿¡ã‚µã‚¤ãƒˆå‘ã‘PiP");
        console.log("- ãƒ•ãƒ¬ãƒ¼ãƒ ã‚­ãƒ£ãƒ—ãƒãƒ£");
        console.log("- å‹•ç”»é ˜åŸŸã‚­ãƒ£ãƒ—ãƒãƒ£");
        console.log("- ç”»é¢ã‚­ãƒ£ãƒ—ãƒãƒ£");
        console.log("- å…¨PiPçµ‚äº†");
      });

      // å‹•ç”»ã®æº–å‚™ãŒã§ããŸã‚‰ãƒ­ã‚°å‡ºåŠ›
      document
        .getElementById("mainVideo")
        .addEventListener("loadedmetadata", () => {
          console.log("ğŸ“º ãƒ¡ã‚¤ãƒ³å‹•ç”»ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãŒèª­ã¿è¾¼ã¾ã‚Œã¾ã—ãŸ");
          console.log(
            "disablepictureinpictureå±æ€§:",
            document
              .getElementById("mainVideo")
              .hasAttribute("disablepictureinpicture")
          );
        });
    </script>
  </body>
</html>
